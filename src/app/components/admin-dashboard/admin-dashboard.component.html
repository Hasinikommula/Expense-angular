<nav class="navbar">
  <div class="navbar-container">
    <div class="logo">Admin Dashboard</div>
    <div class="welcome">
      
    
      <button class="logout-btn" (click)="logout()">Logout</button>
    </div>
    </div>

</nav>

<div class="dashboard-container">
  <div class="tabs">
    <button
      class="tab"
      [class.active]="activeSection === 'overview'"
      (click)="showSection('overview')"
    >
      Groups
    </button>

    <button
      class="tab"
      [class.active]="activeSection === 'users'"
      (click)="showSection('users')"
    >
      Users
    </button>

    <button
      class="tab"
      [class.active]="activeSection === 'manage'"
      (click)="showSection('manage')"
    >
      Manage Users
    </button>
  </div>

  
    <div *ngIf="activeSection === 'manage'">
  <div class="manage-section">
    <h3>Assign User to Group</h3>
    <button class="create-btn" (click)="showAssignForm = !showAssignForm; successMessage = ''">
      + Assign
    </button>
  </div>

  <div *ngIf="successMessage" class="success-msg">
    {{ successMessage }}
  </div>

  <div *ngIf="showAssignForm" class="form-container">
    <form class="inline-form" (ngSubmit)="addUserToGroup(AssigningGroup, Email)" #assignForm="ngForm">
      <h3>Assign User</h3>
      <input type="text" [(ngModel)]="AssigningGroup" name="GroupName" placeholder="Group Name" required />
      <input type="email" [(ngModel)]="Email" name="Email" placeholder="User Email" required />
      <div *ngIf="assignForm.submitted && assignForm.invalid" class="error-msg">
        Group Name and Email are required.
      </div>
      <div class="form-actions">
        <button type="submit" class="save-btn">Assign</button>
        <button type="button" class="cancel-btn" (click)="showAssignForm = false">Cancel</button>
      </div>
    </form>
  </div>

  <table *ngIf="assignments.length > 0" class="assignments-table">
      <thead>
        <tr>
          <th>User Email</th>
          <th>Assigned Group</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let assignment of assignments">
          <td>{{ assignment.userEmail }}</td>
          <td>{{ assignment.groupName }}</td>
        </tr>
      </tbody>
    </table>
  
</div>


  <div *ngIf="activeSection === 'overview'">
    <div class="manage-section">
      <h3>Groups</h3>
      <button class="create-btn" (click)="toggleGroupForm()">
        + Create Group
      </button>
    </div>

    <div *ngIf="showGroupForm" class="form-container">
      <form
        class="inline-form"
        (ngSubmit)="createGroup()"
        #groupForm="ngForm"
      >
        <h3>New Group</h3>
        <input
          type="text"
          [(ngModel)]="newGroup.name"
          name="name"
          placeholder="Group Name"
          required
        />
        <input
          type="text"
          [(ngModel)]="newGroup.description"
          name="description"
          placeholder="Description"
        />
        <div class="form-actions">
          <button type="submit" class="save-btn">Save</button>
          <button type="button" class="cancel-btn" (click)="toggleGroupForm()">
            Cancel
          </button>
        </div>
      </form>
    </div>

    <div class="group-list">
      <div class="group-item" *ngFor="let g of groups">
        <div>
          <strong>{{ g.name }}</strong>
          <p>{{ g.description }}</p>
        </div>
        <div>
          <span>{{ g.members }} Members</span> 
          
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="activeSection === 'users'">
    <div class="manage-section">
      <h3>Users</h3>
      <button class="create-btn" (click)="toggleUserForm()">
        + Create User
      </button>
    </div>

    <div *ngIf="showUserForm" class="form-container">
      <form
        class="inline-form"
        (ngSubmit)="createUser()"
        #userForm="ngForm"
      >
        <h3>New User</h3>
        <input
          type="text"
          [(ngModel)]="newUser.username"
          name="username"
          placeholder="Username"
          required
        />
        <input
          type="email"
          [(ngModel)]="newUser.email"
          name="email"
          placeholder="Email"
          required
        />
        <input
          type="password"
          [(ngModel)]="newUser.password"
          name="password"
          placeholder="Password"
          required
        />

        <div *ngIf="userForm.submitted && userForm.invalid" class="error-msg">
          All fields are required.
        </div>

        <div class="form-actions">
          <button type="submit" class="save-btn">Save</button>
          <button type="button" class="cancel-btn" (click)="toggleUserForm()">
            Cancel
          </button>
        </div>
      </form>
    </div>

    <div class="user-list">
      <div class="user-item" *ngFor="let u of users">
        <div>
          <strong>{{ u.name }}</strong>
          <p>{{ u.email }}</p>
        </div>
      </div>
    </div>
  </div>
</div>